\documentclass[12pt,a4paper]{amsart}

\usepackage{xr}
\externaldocument{../src/LaTex_IEEE_TIT/Goppa--like AG codes_IEEEtran}
%Pour faire les ref au papier sans se faire chier.




%\usepackage{amsaddr}
\usepackage[utf8]{inputenc}
\usepackage{amsmath,amsfonts,amssymb,amsthm,mathtools}
%\usepackage{hyperref}
\usepackage{url}
\usepackage{xcolor}
\usepackage{verbatim}
\usepackage{soul}
\usepackage[margin=2.5cm]{geometry}
\usepackage{enumerate}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{remark}[theorem]{Remark}


%%%%%%COMMENTS%%%%%%
\newcommand\TODO[1]{\textcolor{red}{TO DO: #1}}
\newcommand\DONE[1]{\textcolor{blue}{DONE: #1}}
\newcommand\jade[1]{{\textcolor{purple}{#1}}}
\newcommand\elena[1]{{\textcolor{blue}{#1}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%% Macros are here:

\DeclareMathOperator{\trace}{Tr}
\DeclareMathOperator{\ev}{ev}

\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\End}{\mathrm{End}}
\newcommand{\Fq}[1][]{\mathbb{F}_{q^{#1}}}
\newcommand{\fqm}{\mathbb{F}_{q^m}}
\newcommand{\Roots}{\mathrm{Roots}}
\newcommand{\calC}{\mathcal{C}}
\newcommand{\calX}{\mathcal{X}}
\newcommand{\calP}{\mathcal{P}}
\newcommand{\Tr}[1]{\trace\!\left(#1\right)}
\newcommand{\CPhi}{C_\Phi}


\setlength\parindent{0pt} %NOINDENT

\title[Goppa--like AG codes from $C_{a,b}$ curves and their behaviour under squaring their dual]{Response to the Referee's comments about  \\ ``Goppa--like AG codes from $C_{a,b}$ curves and their behaviour under squaring their dual''} 

\author{Sabira El Khalfaoui, Mathieu Lhotel and Jade Nardi}


\begin{document}

\maketitle

{\itshape
We took into account all the comments of the referees and we modified the manuscript accordingly. To help the referees to better navigate in this answer and the revised version, we have listed all the comments below, followed by our answer.

Note that this work is part of the PhD thesis of the second author, which has been defended since the first submission. We have chosen to implement some remarks of the PhD referees in this revision.
\begin{itemize}
	\item Key sizes in Table \ref{table:comp} are now  given in Megabytes instead of bits: it is more standard and it eases the reading.
	\item Some details about the upper bound have been added in the proof of Prop. \ref{prop:bound_dim_using_inclusions}.
	\item We have shorten the proof of Theorem \ref{thm:bound_with_T_i's_inclusion} by using the second upper bound of Corollary \ref{coro:folklore_upper_bound} directly.
\end{itemize}

\medskip

This revised version respects the journal format. Note that the numeration has changed. Now the introduction section is numbered: Sections 1, 2 and 3 are now Section II, III, and IV. We also reworked some parts to make the paper suitable for the two--column format. Apart from some purely aesthetic modifications, here is a list of significant changes.
\begin{itemize}
	\item To make Table \ref{table:expl_sharpness} fit in one column, we have removed the column regarding the dimension of the square (which is always equal to the length) and we have added a remark about that just after introducing the table.
	\item We have introduced the function $F$ and $G$ in the statement of Proposition \ref{prop:dim_M_i's} to remove long inequalities. The beginning of the proof, about the basis of $\mathcal{R}\left(g^{q^i-q^{i-1}+1}\right)$, has been also slightly modified. It is now more expansive. 
	\item Equivalences regarding degrees in the proof of the Proposition \ref{prop:inclusion_T_i's} are now written with sentences, instead of using symbols $\Leftrightarrow$.
	\item In the proof of Proposition \ref{prop:Hermitian_Goppa_like_are_secured}, we have rewritten the computation for $\mathfrak{B}(e^*)-q_0^3$ into two parts, to avoid long formulae.
\end{itemize}

}
\section*{First review's comment}

The main result of this paper is Theorem \ref{thm:bound_with_T_i's_inclusion} on the upper bound of the dimension of codes. Some problems
of this paper are :
\begin{itemize}
\item  There are many symbols. Please give a clear description of symbols, which can make the paper more readable.

\textit{In this work, we achieve accurate bounds for the dimension of structured codes. We inherently cannot avoid technicalities and intricate notations. Some inaccuracies in the notation that both reviewers pointed out have been fixed in this revised version. We have also made an effort to add references to the first occurrence of symbols when reused later.}


\item  Please give more clear comparisons and show the clear advantages of this paper. Add some results of [NEK21] in Table 1 to give a clear comparison.

\textit{We have reworked the whole paragraph \textbf{Application of Goppa-like AG codes to the McEliece cryptosystem} in the introduction. Now, the parameters for binary Goppa codes and Hermitian subfield subcodes of [NEK21] are displayed in the same table as the ones of Goppa--like Hermitian codes, to make the comparision clearer.}
	
	\item Add some examples in Section 2 to make a comparison with results in Section 3. 
	
	\textit{We also 2 examples in Section \ref{sec:Goppa} and a comparison between results in Sections 2 and 3 in Example \ref{ex:comp}.}

\end{itemize}

\textit{Typos and spelling mistakes have been corrected. Major modifications are listed below.} \\

\begin{itemize}
 
\item  Page 1. Subfield subcodes of AG codes. Line -7. Note the symbols of codes and curve. Check the use of $\calC$ and C; 

\textit{We corrected the use of caligraphical letter in $C_{a,b}$, and we also add some context about the definition of the AG code $\calC$. The notation $\calC$ always represents a code, while $\calX$ is reserved for curves.}
 
\item Page 2. It is better to give a clear description of the advantages of the upper bound of the dimension of codes.

\textit{We have added some sentences in the beginning of the paragraph \textbf{Distinguisher attack} in the introduction to explain why the upper bound provides a distinguisher.}


\item  Page 5. Please check the use of $\Tr{\calC}^{\star 2}$ and $\calC^{q^i}$. It seems that $\Tr{\calC}^{\star 2}$ means $\Tr{\calC^{\star 2}}$. Many similar problems in the paper.

\textit{At this point, we really want to talk about the square of the trace and not the trace of the square. To make it more readable, we changed the notation of the Trace by removing the subscript $\mathbb{F}_{q^m}/\mathbb{F}_q$ (see below Equation \eqref{eq:dim_trace}).}

\noindent Please give a description of $\calC^{q^i}$.
 
\textit{We added a description below Equation \eqref{eq:key_equation}.}

\item Page 6. Note that $\deg G = s$. There are many symbols in the paper. Please give a clear description.

\textit{The definition of the degree of a divisor can be found at page 4. It is a very standard definition in algebraic geometry coding theory: we do not believe it is necessary to recall it at each occurrence. However, we added the missing parenthesis in $\deg\left(\cdot\right)$ where they were not already to clear up some ambiguities.}


\item Page 11. It is better to give some examples at the end of Section 2.

\textit{We added Example \ref{ex:Goppa_vs_Cartier} to compare both Cartier and Goppa-like construction. We present 2 cases: equality and inequality. We also added Example \ref{ex:non_equality_bound} to illustrate Proposition \ref{prop:non-eq}.}



\item Page 18. Check the format of references. Update Reference [MT21].

\textit{We have fixed the references and updated [MT21] into [MT23] (published version).}

\end{itemize} 


\section*{Second review's comment}

\textit{Typos and spelling mistakes have been corrected. Major modifications are listed below.} \\

\begin{itemize}

\item Page 6, line 4: In the second upper bound for the dimension of the Schur square of a trace code in Corollary \ref{coro:first_bound_square_of_trace}, a pair of brackets is missing. More precisely, the formula $m \cdot dim_{\fqm} \calC^{\star 2}-\binom{dim_{\fqm}\calC+1}{2}$ should be $m \cdot \left( dim_{\fqm} \calC^{\star 2} -\binom{dim_{\fqm} \calC+1}{2}\right)$

\textit{We added the missing brackets.}

\item Page 6, proof of Corollary \ref{coro:1st_bound_mumford}: In the proof an upper bound on the dimension of $\Tr{\calC}^{\star 2}$ is given in a series of formulas involving four $\le$ signs. Actually the final three inequalities are equalities. It would be easier for the reader to replace these three inequalities with equalities.

\textit{We took your remark into account and changed the proof accordingly.}


\item Page 7, Definition 13: the constants $\alpha_{0a}$ and $\alpha_{b0}$ are not allowed to be zero. Please add this condition.

\textit{These conditions have been added.} 

\item Page 7, Equation 10: The notation $\mathcal{O}_{P_\infty}$ for the ring $\cup_{s \ge 0} \mathcal{L}(sP_\infty)$ is quite misleading. It is very common to use the notation $\mathcal{O}_{P_\infty}$ for the local ring at $P_\infty$. This is the ring consisting of all functions that do not have a pole at$ P_\infty$. The authors consider in some sense the opposite situation: the ring of all functions with no poles except possibly at $P_\infty$. Please use some other notation.

\textit{Thank you for pointing out this mistake. We changed the notation $\mathcal{O}_{P_\infty}$ into $\mathcal{S}$ which actually is the coordinate ring of the affine curve $\calX_{a,b} \setminus \{P_\infty\}$. We changed the rest of the paper accordingly.}

\item Page 7, line -4: "$f=x^\beta y^\alpha+f'(x,y)$". The authors write that any $f \in \cup_{s \ge 0} \mathcal{L}(sP_\infty)$ can be written in this form, but this is strictly speaking not true. One needs to allow for a leading coefficient different from one as well. Please write something like "$f=c\cdot x^\beta y^\alpha+f'(x,y)$ for some nonzero $c$." This also affects the leading term expression later on.

\textit{Thank you for noticing this. We added a nonzero constant $c$ in front of the expression. To avoid dealing with these constants, we have decided to work with leading \emph{monomials} instead of leading terms. We have changed $\operatorname{LT}(f)$ into $\operatorname{LM}(f)$. As we are working with polynomials with coefficients in a field, it comes down to the same thing.}

\item Page 8, Remark \ref{rq:link_degab_valuation}: "It is worth noting that $\mathcal{O}_{P\infty}$ is a valuation ring with valuation $\nu_{P_\infty}$". This is not true. Indeed, the only valuation ring with valuation $\nu_{P_\infty}$ is the local ring at $P_\infty$. Please modify the remark. It is true that $\deg_{a,b}(f)=-\nu_{P_\infty}(f)$, which is perhaps the main point of the remark.

\textit{We changed the remark, only keeping the link between the valuation at $P_\infty$ and the weighted degree.}


\item Page 8, Definition 2.1: Later on the notation $G$ is used for the divisor $D+(g)$. It would help the reader if this is mentioned already here, since later on, for example in Remark 2.2, the notation $G$ is used without explanation.

\textit{The definition of $G$ has been added before Definition \ref{def:Goppa--like_AG_code}.}


\item Page 10, line 3: In the second summation in this line, there is "$\dim_{F_{q}}$" missing in front of the code $\Tr{\calC \star \calC^{q^i}}$.

\textit{The missing symbol has been added.}

\item Page 11, line 2: The formula "$\calC_1 \subseteq \calC^{q^i} \cap \calC^{q^{m-1}}$" should be "$\calC_1 \subseteq \calC \cap \calC^{q^{m-1}}$". 

\textit{The formula has been corrected.}

\item Page 11, line 4: "$\Tr{\calC \star \calC_1^{q^i}} \subseteq ..."$ should be $"\Tr{\calC_1 \star \calC_1^{q^i}} \subseteq$ ..."

\textit{Actually, the result works with both $\calC_1$ and $\calC$. In the proof, we added a explanation  "By taking th star product ..." to make it clearer.} 

\item Page 11, line 7: in the formula involving the intersection of summations of certain trace codes, the right-hand side is the empty set symbol. Since any code contains 0, I suspect the right-hand side should have been $\{0\}$ instead of $\varnothing$.

\textit{You are completely right. This has been fixed.}

\item Page 11, Remark 2.8: what is the parameter $r$? It is probably the degree of $g$, but I do not recall the authors mentioned this earlier. Please add a short explanation.

\textit{Note that this remark has been merged into Remark \ref{rk:discuss_bound}. We added a reference to classical Goppa codes (Equation \eqref{eq:classical_Goppa}). Here, $r$ is the order of the Goppa code.} 

\item Page 11, Proposition \ref{prop:div_grob}: Since $g$ is the element one wants to divide by (with remainder), I needs to add the condition that $g \neq 0$.

\textit{The condition on $g$ has been added. We also add Definition \ref{def:remainder_space} : it allows us to introduce the notation $\mathcal{R}(h)$ for any function $h \in \mathcal{S}$ as we use it several times later on.} 

\item Page 12, Lemma \ref{lem:weighted_division}: Previously the trace function Tr was only used and defined for elements from a finite field with $q^m$ elements, but now it is applied to a function. This means that not longer $\Tr{f}=\Tr{f^q}$. However, this is used in the proof of the lemma. There is little harm, since later on the results are not applied to functions but to codewords corresponding to them. Please explain briefly before the lemma what exactly is meant with $Tr(f)$ is $f$ is a function, or reformulate in terms of codewords.

\textit{Thank you for bringing this problem to our attention. We added a discussion before Lemma \ref{lem:weighted_division} (see. Section \ref{subsection:study_Tr(C*C_q)}) to explain what we mean by the trace of a function: first, we extend the evaluation map $\ev_{\calP}$ to the ring $\mathcal{S}$ as well as the trace operator by setting $\Tr{f}:=f+f^q+\dots + f^{q^{m-1}}$. Then, given $f,f' \in \mathcal{S}$, we say that $f \equiv_{\calP} f'$ if $\ev_{\calP}(f)=\ev_{\calP}(f')$. Hence, we have $\Tr{f^q} \equiv_{\calP}\Tr{f}$ (see Equation \eqref{eq:prop_trace}). In particular, we have equality of the corresponding evaluation codewords. These new notation are then used for the rest of the paper.}

\item Page 13, first line after Definition \ref{def:T_i's}. "Lemma \ref{lem:weighted_division} entails that ...". Lemma \ref{lem:weighted_division} only applies to $i \ge 1$. Please add a short remark concerning the case $i=0$.

\textit{A short remark for the case $i=0$ has been added.} 

\item Page 13, second line after Definition \ref{def:T_i's}: "$\Tr{\frac{f}{q^{i+1}}}$" should be "$\Tr{\frac{f}{g^{q^i+1}}}$".

\textit{The mistake has been corrected.}

\item Page 13, last line before Subsection \ref{subsection : Upper_bound_Goppa-like}: "the trace codes $\mathcal{T}_i(s,g)$". The sets $\mathcal{T}_i(s,g)$ were defined in Definition \ref{def:T_i's} as sets of functions and not as codes. Did I misunderstand something? Please clarify.

\textit{We changed the definition of the $\mathcal{T}_i(s,g)'s$ (see Definition \ref{def:T_i's}). They are now defined as codes whose codewords are the evaluation at the set of points $\mathcal{P}$ of traces of functions. We hope the terminology "trace codes" makes sense now.}

\end{itemize}

\end{document}